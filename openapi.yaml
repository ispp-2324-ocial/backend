openapi: 3.0.3
info:
  title: Ocial API
  version: 1.1.2
paths:
  /api/chat/{chat_id}/createMessage/:
    post:
      operationId: chat_createMessage_create
      description: Create a new message in a chat
      parameters:
      - in: path
        name: chat_id
        schema:
          type: integer
        required: true
      tags:
      - chat
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageCreate'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/MessageCreate'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/MessageCreate'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Message'
          description: ''
        '400':
          description: Error in request
  /api/chat/{id}/delete/:
    delete:
      operationId: chat_delete_destroy
      description: Delete a chat
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - chat
      security:
      - tokenAuth: []
      - {}
      responses:
        '204':
          description: Chat deleted successfully
        '404':
          description: Chat not found
  /api/chat/{id}/deleteMessage/:
    delete:
      operationId: chat_deleteMessage_destroy
      description: Delete a message
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - chat
      security:
      - tokenAuth: []
      - {}
      responses:
        '204':
          description: Message deleted successfully
        '404':
          description: Message not found
  /api/chat/{id}/messages:
    get:
      operationId: chat_messages_retrieve
      description: Detail of a chat
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - chat
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Chat'
          description: ''
        '404':
          description: Chat not found
  /api/chat/create/:
    post:
      operationId: chat_create_create
      description: Create a new chat
      tags:
      - chat
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Chat'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Chat'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Chat'
      security:
      - tokenAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Chat'
          description: ''
        '400':
          description: Error in request
  /api/chat/list/:
    get:
      operationId: chat_list_list
      description: List of chats
      tags:
      - chat
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Chat'
          description: ''
        '400':
          description: Error in request
  /api/event/{id}/client/:
    get:
      operationId: event_client_retrieve
      description: Get client instance by event id
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OcialClient'
          description: ''
        '404':
          description: Event not found
        '400':
          description: Error in request
  /api/event/{id}/delete/:
    delete:
      operationId: event_delete_destroy
      description: Delete an event
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '204':
          description: El evento se ha eliminado
        '401':
          description: El usuario no ha iniciado sesión
        '400':
          description: El usuario no ha iniciado sesión
        '403':
          description: El usuario no es cliente
        '404':
          description: El evento no existe
  /api/event/{id}/like/:
    get:
      operationId: event_like_list
      description: Get likes of an event
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Like'
          description: List of likes
        '404':
          description: Event not found
    post:
      operationId: event_like_create
      description: Like an event
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Like'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Like'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Like'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Like'
          description: Event liked
        '404':
          description: Event not found
        '401':
          description: Not authenticated
        '400':
          description: Already liked event
    delete:
      operationId: event_like_destroy
      description: Unlike an event
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '204':
          description: Event unliked
        '404':
          description: Event not found
        '401':
          description: Not authenticated
        '400':
          description: Not liked event
  /api/event/{id}/update/:
    put:
      operationId: event_update_update
      description: Update an event
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Event'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Event'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Event'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          description: El evento se ha actualizado
        '401':
          description: El usuario no ha iniciado sesión
        '400':
          description: El usuario no ha iniciado sesión
        '403':
          description: El evento no pertenece al usuario activo
        '422':
          description: El formulario contiene errores
  /api/event/create/:
    post:
      operationId: event_create_create
      description: Create a new event
      tags:
      - event
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Event'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Event'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Event'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '201':
          description: El evento se ha creado
        '401':
          description: No estás logueado
        '400':
          description: El formulario contiene errores
        '403':
          description: El usuario no es cliente
        '422':
          description: La imagen no tiene un formato válido
  /api/event/list/:
    get:
      operationId: event_list_list
      description: List of events
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Event'
          description: ''
        '400':
          description: Error in request
  /api/event/list/client/{id}/:
    get:
      operationId: event_list_client_list
      description: List of events by client id
      parameters:
      - in: path
        name: id
        schema:
          type: integer
        required: true
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Event'
          description: ''
        '401':
          description: No estás logueado
        '404':
          description: No existe el cliente
  /api/event/nearby/:
    get:
      operationId: event_nearby_list
      description: List of events near a location
      parameters:
      - in: query
        name: latitude
        schema:
          type: number
          format: double
        description: Latitude of the center point
        required: true
      - in: query
        name: longitude
        schema:
          type: number
          format: double
        description: Longitude of the center point
        required: true
      - in: query
        name: radius
        schema:
          type: number
          format: double
        description: Radius in kilometers
        required: true
      tags:
      - event
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Event'
          description: ''
        '400':
          description: Error in request
  /api/subscription/create/:
    post:
      operationId: subscription_create_create
      description: Create a new subscription with specific behavior based on subscription
        type.
      tags:
      - subscription
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscriptionCreateUpdate'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/SubscriptionCreateUpdate'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/SubscriptionCreateUpdate'
      security:
      - tokenAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Subscription'
          description: ''
        '400':
          description: Bad Request
        '500':
          description: Internal Server Error
  /api/subscription/delete/:
    delete:
      operationId: subscription_delete_destroy
      description: Delete the current subscription of the authenticated user.
      tags:
      - subscription
      security:
      - tokenAuth: []
      - {}
      responses:
        '204':
          description: Subscription deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Subscription not found
  /api/subscription/get/:
    get:
      operationId: subscription_get_list
      description: Retrieve the current subscription for the authenticated user.
      tags:
      - subscription
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Subscription'
          description: ''
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
  /api/subscription/update/:
    put:
      operationId: subscription_update_update
      description: Update the subscription of the authenticated user
      tags:
      - subscription
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubscriptionCreateUpdate'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/SubscriptionCreateUpdate'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/SubscriptionCreateUpdate'
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionCreateUpdate'
          description: ''
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
  /api/users/client/register/:
    post:
      operationId: users_client_register_create
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Client'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/Client'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/Client'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          description: No response body
        '400':
          description: Los datos de la petición son incorrectos
        '409':
          description: El nombre de usuario o correo ya existe
        '422':
          description: Formato de imagen no válido
  /api/users/login/:
    post:
      operationId: users_login_create
      description: Inicia la sesión del usuario y devuelve el token de autenticación
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginUser'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/LoginUser'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LoginUser'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
          description: Token de autenticación
        '400':
          description: Los datos de la petición son incorrectos
        '401':
          description: Las credenciales son incorrectas
  /api/users/logout/:
    post:
      operationId: users_logout_create
      description: Cierra la sesión del usuario
      tags:
      - users
      security:
      - tokenAuth: []
      responses:
        '200':
          description: No response body
        '304':
          description: Django ha detectado un usuario, pero el token no existe, por
            lo que se considera que la sesión está cerrada
        '401':
          description: El usuario no está autenticado
  /api/users/user/google-oauth2/:
    post:
      operationId: users_user_google_oauth2_create
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleSocialAuth'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/GoogleSocialAuth'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/GoogleSocialAuth'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleSocialAuthResponse'
          description: Datos del usuario autenticado
        '400':
          description: Los datos de la petición son incorrectos
  /api/users/user/register/:
    post:
      operationId: users_user_register_create
      tags:
      - users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/User'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/User'
        required: true
      security:
      - tokenAuth: []
      - {}
      responses:
        '200':
          description: No response body
        '400':
          description: Los datos de la petición son incorrectos
        '409':
          description: El nombre de usuario o correo ya existe
components:
  schemas:
    AuthProviderEnum:
      enum:
      - email
      - google
      type: string
      description: |-
        * `email` - EMAIL
        * `google` - GOOGLE
    CategoryEnum:
      enum:
      - Sports
      - Music
      - Markets
      - Relax activities
      - Live concert
      type: string
      description: |-
        * `Sports` - SPORTS
        * `Music` - MUSIC
        * `Markets` - MARKETS
        * `Relax activities` - RELAX_ACTIVITIES
        * `Live concert` - LIVE_CONCERT
    Chat:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
          readOnly: true
    Client:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        password:
          type: string
          writeOnly: true
        email:
          type: string
          format: email
          writeOnly: true
        username:
          type: string
          writeOnly: true
        imageB64:
          type: string
          writeOnly: true
        image:
          allOf:
          - $ref: '#/components/schemas/Image'
          readOnly: true
        name:
          type: string
        identificationDocument:
          type: string
          maxLength: 9
        typeClient:
          $ref: '#/components/schemas/TypeClientEnum'
        defaultLatitude:
          type: number
          format: double
        defaultLongitude:
          type: number
          format: double
        djangoUser:
          type: integer
      required:
      - defaultLatitude
      - defaultLongitude
      - djangoUser
      - identificationDocument
      - name
      - password
      - username
    Event:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        ocialClient:
          $ref: '#/components/schemas/OcialClient'
        imageB64:
          type: string
          writeOnly: true
        image:
          allOf:
          - $ref: '#/components/schemas/Image'
          readOnly: true
        name:
          type: string
        place:
          type: string
        event:
          type: string
        timeStart:
          type: string
          format: date-time
        timeEnd:
          type: string
          format: date-time
        capacity:
          type: integer
          maximum: 2147483647
          minimum: 0
        category:
          $ref: '#/components/schemas/CategoryEnum'
        latitude:
          type: number
          format: double
        longitude:
          type: number
          format: double
      required:
      - event
      - latitude
      - longitude
      - name
      - ocialClient
      - place
    GoogleSocialAuth:
      type: object
      properties:
        auth_token:
          type: string
      required:
      - auth_token
    GoogleSocialAuthResponse:
      type: object
      properties:
        token:
          type: string
          readOnly: true
        isClient:
          type: boolean
      required:
      - isClient
    Image:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        image:
          type: string
          format: uri
        blurhash:
          type: string
      required:
      - blurhash
      - image
    Like:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        event:
          type: integer
        user:
          type: integer
      required:
      - event
      - user
    LoginUser:
      type: object
      description: |-
        Serializer for user login.

        Fields:
        - `username` (string): The username of the user.
        - `password` (string): The password of the user.
      properties:
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        password:
          type: string
          maxLength: 128
      required:
      - password
      - username
    Message:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        content:
          type: string
          maxLength: 255
        chatId:
          type: integer
      required:
      - chatId
      - content
    MessageCreate:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        content:
          type: string
          maxLength: 255
      required:
      - content
    OcialClient:
      type: object
      properties:
        name:
          type: string
        defaultLatitude:
          type: number
          format: double
        defaultLongitude:
          type: number
          format: double
      required:
      - defaultLatitude
      - defaultLongitude
      - name
    Subscription:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        typeSubscription:
          $ref: '#/components/schemas/TypeSubscriptionEnum'
        numEvents:
          type: integer
          maximum: 2147483647
          minimum: 0
        canEditEvent:
          type: boolean
        canSendNotifications:
          type: boolean
        canHaveRecurrentEvents:
          type: boolean
        canHaveOustandingEvents:
          type: boolean
        canHaveRating:
          type: boolean
        ocialClientId:
          type: integer
      required:
      - ocialClientId
    SubscriptionCreateUpdate:
      type: object
      properties:
        typeSubscription:
          $ref: '#/components/schemas/TypeSubscriptionEnum'
    TokenResponse:
      type: object
      properties:
        token:
          type: string
          readOnly: true
        isClient:
          type: boolean
      required:
      - isClient
    TypeClientEnum:
      enum:
      - Small business
      - Artist
      - Bar Restaurant
      - Local Guide
      - Events And Concerts
      type: string
      description: |-
        * `Small business` - SMALL_BUSINESS
        * `Artist` - ARTIST
        * `Bar Restaurant` - BAR_RESTAURANT
        * `Local Guide` - LOCAL_GUIDE
        * `Events And Concerts` - EVENTS_AND_CONCERTS
    TypeSubscriptionEnum:
      enum:
      - Free
      - Basic
      - Pro
      type: string
      description: |-
        * `Free` - FREE
        * `Basic` - BASIC
        * `Pro` - PRO
    User:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        password:
          type: string
          writeOnly: true
        email:
          type: string
          format: email
          writeOnly: true
        username:
          type: string
          writeOnly: true
        auth_provider:
          $ref: '#/components/schemas/AuthProviderEnum'
        lastKnowLocLat:
          type: number
          format: double
        lastKnowLocLong:
          type: number
          format: double
        djangoUser:
          type: integer
      required:
      - djangoUser
      - lastKnowLocLat
      - lastKnowLocLong
      - password
      - username
  securitySchemes:
    tokenAuth:
      type: apiKey
      in: header
      name: Authorization
      description: Token-based authentication with required prefix "Token"
